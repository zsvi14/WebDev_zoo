<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../CSS_JS/style_siham.css">
    <title>Liste des Enclos</title>
</head>
<body>
    <header>
        <button class="home-button" onclick="window.location.href='../connexion/home.html';">Retour √† l'accueil</button>
        <h1 class="park-name">ü¶íüêòü¶ì Le rrrh parc ü¶Åü¶ìü¶í</h1>
    </header>

    <h1 id="title_enclos">Liste des Enclos</h1>
    <div id="enclos-container"></div>

    <script>
        function afficherEnclos(data) {
            const container = document.getElementById('enclos-container');
            container.innerHTML = '';
            if (!data || data.length === 0) {
                container.innerHTML = '<p>Aucun enclos trouv√©.</p>';
                return;
            }

            const enclosMap = {};
            data.forEach(item => {
                if (!enclosMap[item.id_enclos]) {
                    enclosMap[item.id_enclos] = {
                        id: item.id_enclos,
                        nom_enclos: item.nom_enclos,
                        biome: item.biome,
                        animaux: []
                    };
                }
                enclosMap[item.id_enclos].animaux.push(item.animal);
            });

            Object.keys(enclosMap).forEach(enclosId => {
                const enclos = enclosMap[enclosId];
                const enclosDiv = document.createElement('div');
                enclosDiv.classList.add('enclos');
                enclosDiv.innerHTML = `
                    <h3>${enclos.nom_enclos} (Biome : ${enclos.biome})</h3>
                    <ul>
                        ${enclos.animaux.map(animal => `<li>${animal}</li>`).join('')}
                    </ul>
                    <button onclick="window.location.href='details_enclos.php?id=${enclos.id}'">Voir d√©tails</button>
                `;
                container.appendChild(enclosDiv);
            });
        }

        function fetchEnclos() {
            fetch('http://localhost/WebDev_zoo/back/routes/enclos.php')
                .then(response => response.json())
                .then(data => afficherEnclos(data))
                .catch(error => {
                    console.error('Erreur :', error);
                    document.getElementById('enclos-container').innerHTML = '<p>Erreur lors du chargement des enclos.</p>';
                });
        }

        window.onload = fetchEnclos;
    </script>
</body>
</html>
