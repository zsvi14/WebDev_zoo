<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <link rel="stylesheet" href="../../CSS_JS/style_siham.css">
    <title>Liste des Enclos</title>
</head>
<header>
    <button class="home-button" onclick="window.location.href='../connexion/home.html';">Retour à l'accueil</button>
    <h1 class="park-name">🦒🐘🦓Le rrrh parc🦁🦓🦒</h1>
</header>

<body>
    <h1 id="title_enclos">Liste des Enclos</h1>
  
    <div id="enclos-container">
        <!-- La liste des enclos sera affichée ici dynamiquement -->
    </div>

    <script>
        // Fonction pour afficher les enclos avec leurs animaux
        function afficherEnclos(data) {
            const container = document.getElementById('enclos-container');
            container.innerHTML = '';

            if (!data || data.length === 0) {
                container.innerHTML = '<p>Aucun enclos trouvé.</p>';
                return;
            }

            const enclosMap = {};
            data.forEach(item => {
                if (!enclosMap[item.nom_enclos]) {
                    enclosMap[item.nom_enclos] = {
                        biome: item.biome,
                        animaux: []
                    };
                }
                enclosMap[item.nom_enclos].animaux.push(item.animal);
            });

            // Affichage des enclos avec animaux
            Object.keys(enclosMap).forEach(nomEnclos => {
                const enclos = enclosMap[nomEnclos];
                const enclosDiv = document.createElement('div');
                enclosDiv.classList.add('enclos-card');

                // Titre de l'enclos
                const enclosTitle = document.createElement('h3');
                enclosTitle.textContent = `${nomEnclos} (Biome : ${enclos.biome})`;
                enclosDiv.appendChild(enclosTitle);

                // Liste des animaux
                if (enclos.animaux.length > 0) {
                    const animauxContainer = document.createElement('div');
                    animauxContainer.classList.add('animaux-container');
                    enclos.animaux.forEach(animal => {
                        const animalDiv = document.createElement('div');
                        animalDiv.classList.add('animal-card');

                        // Créer un lien pour chaque animal
                        const link = document.createElement('a');
                        link.href = `details_animal.php?animal=${encodeURIComponent(animal)}`;

                        // Affichage de l'image de l'animal
                        const photoPath = `../../image_enclos/${animal.toLowerCase().replace(/\s+/g, '_')}.jpg`; 
                        const img = document.createElement('img');
                        img.src = photoPath;
                        img.alt = `Photo de ${animal}`;
                        img.classList.add('animal-image'); // Classe CSS pour l'image

                        // Nom de l'animal
                        const animalName = document.createElement('p');
                        animalName.textContent = animal;
                        animalDiv.appendChild(link);
                        link.appendChild(img);
                        link.appendChild(animalName);

                        animauxContainer.appendChild(animalDiv);
                    });
                    enclosDiv.appendChild(animauxContainer);
                } else {
                    const noAnimalText = document.createElement('p');
                    noAnimalText.textContent = 'Aucun animal dans cet enclos.';
                    enclosDiv.appendChild(noAnimalText);
                }

                container.appendChild(enclosDiv);
            });
        }

        // Fonction pour récupérer les enclos
        function fetchEnclos() {
            fetch('http://localhost/WebDev_zoo/back/routes/enclos.php')
                .then(response => response.json())
                .then(data => {
                    afficherEnclos(data);
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération des données :', error);
                });
        }

        window.onload = fetchEnclos;
    </script>
</body>
</html>
